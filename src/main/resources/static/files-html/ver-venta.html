<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ðŸ“ˆ - Detalle de Venta</title>
  <link rel="stylesheet" href="../files-css/style.css"/>
  <link rel="stylesheet" href="../files-css/ver-venta.css"/>
  <link rel="stylesheet" href="../files-css/nav.css"/>
</head>
<body>
  <div id="app-header"></div>

  <main class="page page-detail">
    
    <div class="detail-header">
      <div class="title-group">
        <h1>Venta <span id="saleId">...</span></h1>
        <div class="breadcrumbs">
        </div>
      </div>
      <div class="actions-toolbar">
        <a id="btnCrearEntrega" class="btn primary" style="display:none;">Crear entrega</a>
        <div class="btn-group">
          <a id="btnEditar" class="btn primary">Editar</a>
          <a class="btn outline" href="ventas.html">Volver</a>
        </div>
      </div>
    </div>

    <hr class="divider">

    <div class="content-wrapper">
      <div class="main-column">
        
        <section class="info-list">
          
          <div class="info-row">
            <span class="label">Fecha</span>
            <span class="value" id="fecha">â€”</span>
          </div>

          <div class="info-row">
            <span class="label">Cliente</span>
            <span class="value strong text-uppercase" id="cliente">â€”</span>
          </div>

          <div class="info-row" id="rowPedido">
            <span class="label">Presupuesto asociado</span>
            <span class="value" id="pedido">â€”</span>
          </div>

          <div class="info-row">
            <span class="label">Estado de pago</span>
            <span class="value">
              <span id="estadoPago" class="pill">â€”</span>
            </span>
          </div>

          <div class="info-row" id="rowEstadoEntrega">
            <span class="label">Estado de entrega</span>
            <span class="value">
              <span id="estadoEntrega" class="pill">â€”</span>
            </span>
          </div>

          <div class="info-row" id="rowEntregas">
            <span class="label">Resumen Entregas</span>
            <span class="value" id="entregasResumen">â€”</span>
          </div>

          <div class="info-row highlight-row">
            <span class="label">Total Venta</span>
            <span class="value strong" id="total">$ 0,00</span>
          </div>
          <div class="info-row">
            <span class="label">Pagado</span>
            <span class="value" id="pagado">$ 0,00</span>
          </div>
          <div class="info-row" style="border-bottom:none;">
            <span class="label">Saldo Pendiente</span>
            <span class="value strong text-danger" id="saldo">$ 0,00</span>
          </div>

        </section>

        <section class="items-section">
          <h3>ArtÃ­culos de la venta</h3>
          
          <div class="tabla-clean" id="tablaItems">
            <div class="thead">
              <div style="flex: 2;">Material</div>
              <div class="text-center">Cantidad</div>
              <div class="text-right">Precio Unit.</div>
              <div class="text-right">Subtotal</div>
            </div>
            </div>
          <p id="msgItems" class="empty-msg" style="display:none;"></p>
        </section>

        <hr class="divider" style="margin: 40px 0;">

        <section class="items-section" id="cardEntregasVenta">
          <h3>Entregas realizadas</h3>
          <div class="tabla-clean" id="tablaEntregasVenta">
            <div class="thead">
              <div style="flex: 0.5;">ID</div>
              <div>Fecha</div>
              <div style="flex: 2;">Resumen</div>
              <div class="text-center">Estado</div>
              <div class="text-right">Acciones</div>
            </div>
          </div>
          <p id="msgEntregasVenta" class="empty-msg" style="display:none;"></p>
        </section>

        <hr class="divider" style="margin: 40px 0;">

        <section class="items-section">
          <div class="section-header">
            <h3>Pagos registrados</h3>
            <a id="btnRegistrarPago2" class="btn outline small">+ Registrar pago</a>
          </div>
          
          <div class="tabla-clean" id="tablaPagos">
            <div class="thead">
              <div>Fecha</div>
              <div>MÃ©todo</div>
              <div class="text-center">Estado</div>
              <div class="text-right">Importe</div>
            </div>
          </div>
          <p id="msgPagos" class="empty-msg" style="display:none;"></p>
        </section>

      </div>
    </div>
  </main>

  <dialog id="payDialog" class="pay-dialog">
    <form method="dialog" id="payForm" class="pay-form" autocomplete="off">
      <header class="pay-head">
        <h3>Registrar pago</h3>
        <button type="button" class="icon-btn" id="payClose" aria-label="Cerrar">âœ–</button>
      </header>
      <div class="pay-body">
        <div class="row">
          <label class="stack">
            <span>Fecha</span>
            <input id="payDate" type="date" required />
          </label>
          <label class="stack">
            <span>Importe</span>
            <input id="payAmount" type="number" step="0.01" min="0.01" inputmode="decimal" required />
            <small class="hint" id="payHintSaldo">Saldo: â€”</small>
          </label>
        </div>
        <label class="stack">
          <span>MÃ©todo de pago</span>
          <select id="payMethod" required>
            <option value="">Seleccionarâ€¦</option>
            <option value="CASH">Efectivo</option>
            <option value="TRANSFER">Transferencia</option>
            <option value="CARD">Tarjeta</option>
            <option value="OTHER">Otro</option>
          </select>
        </label>
      </div>
      <footer class="pay-foot">
        <button type="submit" class="btn green">Guardar pago</button>
        <button type="button" class="btn outline" id="payCancel">Cancelar</button>
      </footer>
    </form>
  </dialog>

  <script src="../files-js/core/api.js"></script>
  <script>window.api.setBaseUrl('http://localhost:8088');</script>
  <script src="../files-js/header.js"></script>
  <script src="../files-js/menu-guard.js"></script>
  <script src="../files-js/ver-venta.js"></script>
</body>
</html>